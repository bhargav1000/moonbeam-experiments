<!DOCTYPE html>
<html lang="en">
  <head>

<style>
  body {
    text-align: center;
    font-family: Arial, Helvetica, sans-serif;
  }

  div {
    width: 20%;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
  }

  button {
    width: 100%;
    margin: 10px 0px 5px 0px;
  }
</style>

</head>
  <body>
  <div>
    <h1>This is my dApp!</h1>
    <p>Here we can set or get the mood:</p>
    <label for="mood">Input Mood:</label> <br />
    <input type="text" id="mood" />

    <button onclick="getMood()">Get Mood</button>
    <button onclick="setMood()">Set Mood</button>
    <p id="showMood"></p>
  </div>
</body>

<script>
        var getMood
        var setMood
</script>


<script type="module">
    import {
        createWalletClient,
        custom,
        getContract,
    } from "https://esm.sh/viem";
    import { sepolia } from "https://esm.sh/viem/chains";

    //creating a client that connects the user's account to Ethereum Sepolia
    const walletClient = createWalletClient({
            chain: sepolia,
            transport: custom(window.ethereum),
            });

    //accounts will be an array
    const accounts = await walletClient.requestAddresses();

    //get the first address in the accounts array
    const [address] = accounts;

    const MoodContractAddress = "0x10121b9a5589437e2a3b151146c5B52d7D1fFa2a";
    const MoodContractABI = [
	{
		"inputs": [],
		"name": "getMood",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_mood",
				"type": "string"
			}
		],
		"name": "setMood",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	}
];


const MoodContractInstance = getContract({
          address: MoodContractAddress,
          abi: MoodContractABI,
          client: walletClient,
        });

getMood= async function() {
          const mood = await MoodContractInstance.read.getMood();
          document.getElementById("showMood").innerText = `Your Mood: ${mood}`;
        }

setMood= async function() {
          const mood = document.getElementById("mood").value;
          await MoodContractInstance.write.setMood([mood],{
            account:address
          });
        }

</script>

</html>